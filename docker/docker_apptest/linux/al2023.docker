FROM amazonlinux:2023.0.20230308.0

WORKDIR /

# install systemd deps
RUN yum install systemd kernel-libbpf -y

# install the app
ENV INSTALLER_SUFFIX=.rpm
ENV ARCH=x86_64
ENV INSTALLER_FILE=app*${ARCH}${INSTALLER_SUFFIX}
ENV SETTINGS_FILE=app.json

COPY ./$INSTALLER_FILE .
RUN yum install $INSTALLER_FILE man unzip -y

RUN mkdir -p /etc/app/
COPY ./$SETTINGS_FILE /etc/app/app
RUN systemctl enable app

CMD ["/lib/systemd/systemd"]
